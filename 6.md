# 第六章 虚拟存储器

## 1. 传统存储管理方式的特征和缺点

1. 一次性：作业必须一次性全部装入内存。

   1. 大作业无法运行
   2. 并发性下降
2. 驻留性：一直驻留在内存中。

   1. 浪费内存资源

## 2. 局部性原理 

1. 时间局部性
2. 空间局部性

## 3. 虚拟存储器的特征

1. 多次性
2. 对换性
3. 虚拟性

## 4. 请求分页存储管理方式：

1. 当访问的信息不在内存中，由操作系统负责将所需信息将外存调入内存，然后继续执行程序（缺页中断机制，请求调页功能）
2. 内存空间不够时，由操作系统负责将内存中暂时用不到的信息换到外存（页面置换功能）
3. 请求页表机制：
   |页号|物理块号|状态位P|访问字段A|修改位M|外存地址|
   |---|-------|------|--------|------|-------|
   1.  状态位 `P` 指示该页是否已经调入内存
   2.  访问字段 `A` 记录本页在一段时间内被访问的次数，或记录本页最近已有多长时间未被访问
   3.  修改位 `M` （脏位）：标志该页在调入内存后是否被修改过
   4.  外存地址：通常是物理块号
4. 缺页中断机构： 在请求终端机构中，每当要访问的页面不在内存时，产生一个缺页中断，由操作系统的缺页中断处理程序处理中断。此时缺页的进程阻塞，放入阻塞队列，调页完成后再将其唤醒，放入就绪队列。**缺页中断属于内终端**
   1. 如果此时内存中有空闲块，则为该进程分配一个空闲块，将所缺页面装入该块，并修改页表中相应的页表项
   2. 如果此时内存中没有空闲块，则由页面置换算法选择一个页面淘汰。若该页面在内存期间被修改过，则要其写回外存
   3. 一条指令执行的时候可能产生多次缺页中断

## 5. 页面置换算法

### 1. 最佳置换算法（OPT）:

    每次选择淘汰的页面将会是以后永不使用或者在未来最长时间不再被使用的页面，这样可以保证缺页率最低(理想化算法，无法实现)

### 2. 先进先出置换算法（FIFO）:

    用一个循环队列来模拟这个过程，每次选择淘汰的页面是最早进入内存的页面，队列的最大长度取决于系统为进程分配了多少个内存块
    Belady 异常： 为进程分配的物理块增长时，缺页率不降反升

### 3. 最近最久未使用置换算法（LRU）:

   1. 实现方法：用页表项的访问字段记录该页面自上次被访问以来所经历的时间 `t` , 当需要淘汰一个页面时，选一个现有页面 `t` 最大的  
   2. 性能好 实现困难， 开销大
